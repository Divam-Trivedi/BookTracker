{% extends 'library/base.html' %}

{% block title %}Search Results{% endblock %}

{% block content %}
<section style="padding: 40px;">
  <h2 style="text-align: center; margin-bottom: 30px;">
    {% if query %}Results for "{{ query }}" {% else %}Search for books{% endif %}
  </h2>

  {% if results %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px;">
      {% for book in results %}
        <div style="background: #fff; border-radius: 8px; overflow: hidden; border: 1px solid #ddd; display: flex; flex-direction: column; align-items: center; padding: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">

          <div style="width: 100%; height: 300px; display: flex; align-items: center; justify-content: center; background-color: #fff;">
            {% if book.cover_url %}
              <img src="{{ book.cover_url }}" alt="{{ book.title }}" 
              style="max-height: 100%; max-width: 100%; object-fit: contain; image-rendering: auto; background: white;" 
              onerror="this.onerror=null; this.src='/static/images/no_image.png';">
            {% else %}
              <img src="/static/images/no_image.png" alt="No Image" 
              style="max-height: 100%; max-width: 100%; object-fit: contain; image-rendering: auto; background: white;"/>
            {% endif %}
          </div>

          <h3 style="text-align: center; margin: 10px 0 5px 0;">{{ book.title }}</h3>
          <p style="color: #555; font-style: italic; text-align: center;">by {{ book.authors }}</p>
          <p style="color: #777; font-size: 0.9em; text-align: center;">Genre: {{ book.categories }}</p>

          <form method="POST" action="{% url 'add_to_library' book.id %}">
            {% csrf_token %}
            <button type="submit">Add to Library</button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="text-align: center; color: #888;">No books found. Try a different search.</p>
  {% endif %}
</section>
{% endblock %}
